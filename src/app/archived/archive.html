<div class="archive-page">
  <h2>Archives</h2>

  <div class="tabs">
    <button type="button"
            (click)="setTab('all')"
            [class.active]="tab === 'all'">
      All
    </button>

    <button type="button"
            (click)="setTab('pages')"
            [class.active]="tab === 'pages'">
      Pages
    </button>

    <button type="button"
            (click)="setTab('banners')"
            [class.active]="tab === 'banners'">
      Banners
    </button>
  </div>

  <div *ngIf="isLoading">Loading archives...</div>
  <div *ngIf="error" class="error">{{ error }}</div>

  <!-- ========== ALL (Pages + Banners) ========== -->
  <div *ngIf="!isLoading && !error && tab === 'all'">
    <h3>Archived Pages</h3>
    <p *ngIf="archivedPages.length === 0">No archived pages.</p>

    <div class="item" *ngFor="let p of archivedPages">
      <div class="item-header">
        <h4>{{ p.title }}</h4>
        <button class="btn-outline" (click)="openPreview(p, 'page')">Preview</button>
      </div>
      <p class="muted">/{{ p.slug }}</p>
      <p>
        <strong>Archived:</strong>
        {{ p.archivedAt | date: 'MMM d, y, h:mm a' }}
      </p>
      <p *ngIf="p.archiveType">
        <strong>Reason:</strong> {{ p.archiveType }}
      </p>
    </div>

    <h3 style="margin-top:24px;">Archived Banners</h3>
    <p *ngIf="archivedBanners.length === 0">No archived banners.</p>

    <div class="item" *ngFor="let b of archivedBanners">
      <div class="item-header">
        <h4>{{ b.title }}</h4>
        <button class="btn-outline" (click)="openPreview(b, 'banner')">Preview</button>
      </div>
      <p>
        <strong>Archived:</strong>
        {{ (b.archivedAt || b.expiredAt) | date: 'MMM d, y, h:mm a' }}
      </p>
      <p *ngIf="b.status">
        <strong>Status:</strong> {{ b.status }}
      </p>
    </div>
  </div>

  <!-- ========== PAGES ONLY ========== -->
  <div *ngIf="!isLoading && !error && tab === 'pages'">
    <h3>Archived Pages</h3>
    <p *ngIf="archivedPages.length === 0">No archived pages.</p>

    <div class="item" *ngFor="let p of archivedPages">
      <div class="item-header">
        <h4>{{ p.title }}</h4>
        <button class="btn-outline" (click)="openPreview(p, 'page')">Preview</button>
      </div>
      <p class="muted">/{{ p.slug }}</p>
      <p>
        <strong>Archived:</strong>
        {{ p.archivedAt | date: 'MMM d, y, h:mm a' }}
      </p>
      <p *ngIf="p.archiveType">
        <strong>Reason:</strong> {{ p.archiveType }}
      </p>
    </div>
  </div>

  <!-- ========== BANNERS ONLY ========== -->
  <div *ngIf="!isLoading && !error && tab === 'banners'">
    <h3>Archived Banners</h3>
    <p *ngIf="archivedBanners.length === 0">No archived banners.</p>

    <div class="item" *ngFor="let b of archivedBanners">
      <div class="item-header">
        <h4>{{ b.title }}</h4>
        <button class="btn-outline" (click)="openPreview(b, 'banner')">Preview</button>
      </div>
      <p>
        <strong>Archived:</strong>
        {{ (b.archivedAt || b.expiredAt) | date: 'MMM d, y, h:mm a' }}
      </p>
      <p *ngIf="b.status">
        <strong>Status:</strong> {{ b.status }}
      </p>
    </div>
  </div>
</div>

<!-- ========== PREVIEW MODAL ========== -->
<div class="modal-backdrop" *ngIf="previewItem && previewType">
  <div class="modal">
    <div class="modal-header">
      <h3 *ngIf="previewType === 'page'">Archived Page Preview</h3>
      <h3 *ngIf="previewType === 'banner'">Archived Banner Preview</h3>
      <button class="close-btn" (click)="closePreview()">Ã—</button>
    </div>

    <div class="modal-body" *ngIf="previewItem as item">
      <!-- PAGE PREVIEW -->
      <ng-container *ngIf="previewType === 'page'">
        <p><strong>Title:</strong> {{ item.title }}</p>
        <p><strong>Slug:</strong> /{{ item.slug }}</p>
        <p *ngIf="item.category"><strong>Category:</strong> {{ item.category }}</p>
        <p *ngIf="item.publishDate">
          <strong>Published:</strong> {{ item.publishDate | date:'MMM d, y, h:mm a' }}
        </p>
        <p *ngIf="item.author"><strong>Author:</strong> {{ item.author }}</p>
        <p *ngIf="item.tags?.length">
          <strong>Tags:</strong> {{ item.tags.join(', ') }}
        </p>

        <hr />

        <p *ngIf="item.description">
          <strong>Description:</strong><br />
          {{ item.description }}
        </p>

        <p *ngIf="item.content">
          <strong>Content:</strong><br />
          <span class="preformatted">{{ item.content }}</span>
        </p>
      </ng-container>

      <!-- BANNER PREVIEW -->
      <ng-container *ngIf="previewType === 'banner'">
        <p><strong>Title:</strong> {{ item.title }}</p>
        <p *ngIf="item.imageUrl">
          <strong>Image URL:</strong> {{ item.imageUrl }}
        </p>
        <p *ngIf="item.link">
          <strong>Link:</strong> {{ item.link }}
        </p>
        <p *ngIf="item.status">
          <strong>Status:</strong> {{ item.status }}
        </p>

        <p *ngIf="item.publishDate">
          <strong>Publish Date:</strong> {{ item.publishDate | date:'MMM d, y, h:mm a' }}
        </p>
        <p *ngIf="item.expireDate">
          <strong>Expire Date:</strong> {{ item.expireDate | date:'MMM d, y, h:mm a' }}
        </p>

        <hr />

        <p *ngIf="item.content">
          <strong>Content:</strong><br />
          <span class="preformatted">{{ item.content }}</span>
        </p>
      </ng-container>
    </div>

    <div class="modal-footer">
      <button class="btn-outline" (click)="closePreview()">Close</button>
    </div>
  </div>
</div>
